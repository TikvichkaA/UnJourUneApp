import{c as u,p as y}from"./middleware-EJ6QVAsm.js";const c=l=>Math.floor(Math.sqrt(l/100))+1,k=u()(y((l,r)=>({lessonsCompleted:[],lessonAttempts:{},drillsStats:{},currentStreak:0,skillScores:{},totalXP:0,level:1,lastPlayedAt:null,dailyGoalProgress:{puzzlesSolved:0,minutesPlayed:0},completeLesson:(t,e)=>{const s=r();if(!s.lessonsCompleted.includes(t)){const o=(s.skillScores[e]||0)+10,a=s.totalXP+25;l({lessonsCompleted:[...s.lessonsCompleted,t],skillScores:{...s.skillScores,[e]:o},totalXP:a,level:c(a),lastPlayedAt:new Date().toISOString()})}},failLesson:t=>{const e=r();l({lessonAttempts:{...e.lessonAttempts,[t]:(e.lessonAttempts[t]||0)+1}})},completeDrill:(t,e,s)=>{const o=r(),a=o.drillsStats[t]||{completed:0,correct:0,avgTime:0,bestStreak:0},i=a.completed+1,S=a.correct+(e?1:0),m=(a.avgTime*a.completed+s)/i,n=e?o.currentStreak+1:0,p=Math.max(a.bestStreak,n),P=e?10+Math.floor(n/3)*5:2,d=o.totalXP+P;l({drillsStats:{...o.drillsStats,[t]:{completed:i,correct:S,avgTime:m,bestStreak:p}},currentStreak:n,totalXP:d,level:c(d),lastPlayedAt:new Date().toISOString(),dailyGoalProgress:{...o.dailyGoalProgress,puzzlesSolved:o.dailyGoalProgress.puzzlesSolved+1}})},addXP:t=>{const s=r().totalXP+t;l({totalXP:s,level:c(s)})},updateDailyGoal:(t,e)=>{const s=r();l({dailyGoalProgress:{puzzlesSolved:t??s.dailyGoalProgress.puzzlesSolved,minutesPlayed:e??s.dailyGoalProgress.minutesPlayed}})},resetDailyGoal:()=>{l({dailyGoalProgress:{puzzlesSolved:0,minutesPlayed:0}})},getSkillLevel:t=>{const e=r().skillScores[t]||0;return e>=100?5:e>=70?4:e>=40?3:e>=20?2:e>=5?1:0}}),{name:"chess-master-progress"}));export{k as u};
