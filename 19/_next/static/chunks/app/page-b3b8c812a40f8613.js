(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{2267:function(e,s,t){Promise.resolve().then(t.bind(t,146))},146:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return el}});var l=t(7437),a=t(2265),r=t(3011);let i=[{id:"1",nom:"Jean Dupont",email:"jean.dupont@ville.fr",role:"agent"},{id:"2",nom:"Marie Martin",email:"marie.martin@ville.fr",role:"agent"},{id:"3",nom:"Pierre Durand",email:"pierre.durand@ville.fr",role:"responsable"},{id:"4",nom:"Sophie Bernard",email:"sophie.bernard@ville.fr",role:"admin"}],n=[{id:"1",nom:"Voirie",description:"Probl\xe8mes de chauss\xe9e, trottoirs, signalisation",couleur:"#ef4444"},{id:"2",nom:"\xc9clairage public",description:"Lampadaires d\xe9faillants, zones sombres",couleur:"#f59e0b"},{id:"3",nom:"Espaces verts",description:"Parcs, jardins, arbres",couleur:"#22c55e"},{id:"4",nom:"Propret\xe9",description:"D\xe9p\xf4ts sauvages, poubelles, graffitis",couleur:"#3b82f6"},{id:"5",nom:"Mobilier urbain",description:"Bancs, abribus, panneaux",couleur:"#8b5cf6"}],o=[{id:"1",titre:"Nid de poule rue de la Mairie",description:"Un nid de poule important s'est form\xe9 devant le n\xb015 rue de la Mairie. Dangereux pour les v\xe9los et pi\xe9tons.",categorie:"Voirie",statut:"en_cours",priorite:"haute",localisation:"15 rue de la Mairie",photos:["/placeholder-photo.jpg"],cree_par:i[0],assigne_a:i[1],date_creation:"2024-01-15T09:30:00",date_modification:"2024-01-16T14:20:00",historique:[{id:"h1",date:"2024-01-15T09:30:00",type:"creation",description:"Signalement cr\xe9\xe9",auteur:"Jean Dupont"},{id:"h2",date:"2024-01-15T10:00:00",type:"affectation",description:"Affect\xe9 \xe0 Marie Martin",auteur:"Pierre Durand"},{id:"h3",date:"2024-01-16T14:20:00",type:"statut",description:'Statut chang\xe9 vers "En cours"',auteur:"Marie Martin"}],commentaires:[{id:"c1",signalement_id:"1",auteur:i[1],contenu:"Intervention pr\xe9vue demain matin.",date:"2024-01-16T14:25:00"}]},{id:"2",titre:"Lampadaire \xe9teint Place du March\xe9",description:"Le lampadaire situ\xe9 \xe0 l'angle nord-est de la Place du March\xe9 ne fonctionne plus depuis 3 jours.",categorie:"\xc9clairage public",statut:"nouveau",priorite:"normale",localisation:"Place du March\xe9 - angle nord-est",photos:[],cree_par:i[0],assigne_a:null,date_creation:"2024-01-17T11:00:00",date_modification:"2024-01-17T11:00:00",historique:[{id:"h4",date:"2024-01-17T11:00:00",type:"creation",description:"Signalement cr\xe9\xe9",auteur:"Jean Dupont"}],commentaires:[]},{id:"3",titre:"Branche cass\xe9e Parc Central",description:"Une grosse branche est tomb\xe9e et bloque partiellement l'all\xe9e principale du parc.",categorie:"Espaces verts",statut:"resolu",priorite:"haute",localisation:"Parc Central - all\xe9e principale",photos:["/placeholder-photo.jpg"],cree_par:i[1],assigne_a:i[0],date_creation:"2024-01-10T08:00:00",date_modification:"2024-01-11T16:00:00",historique:[{id:"h5",date:"2024-01-10T08:00:00",type:"creation",description:"Signalement cr\xe9\xe9",auteur:"Marie Martin"},{id:"h6",date:"2024-01-10T09:00:00",type:"affectation",description:"Affect\xe9 \xe0 Jean Dupont",auteur:"Pierre Durand"},{id:"h7",date:"2024-01-11T16:00:00",type:"statut",description:'Statut chang\xe9 vers "R\xe9solu"',auteur:"Jean Dupont"}],commentaires:[{id:"c2",signalement_id:"3",auteur:i[0],contenu:"Branche d\xe9gag\xe9e et \xe9vacu\xe9e.",date:"2024-01-11T16:00:00"}]},{id:"4",titre:"D\xe9p\xf4t sauvage rue des Lilas",description:"Des encombrants ont \xe9t\xe9 abandonn\xe9s sur le trottoir devant le n\xb08.",categorie:"Propret\xe9",statut:"bloque",priorite:"normale",localisation:"8 rue des Lilas",photos:["/placeholder-photo.jpg"],cree_par:i[2],assigne_a:i[0],date_creation:"2024-01-14T14:30:00",date_modification:"2024-01-16T09:00:00",historique:[{id:"h8",date:"2024-01-14T14:30:00",type:"creation",description:"Signalement cr\xe9\xe9",auteur:"Pierre Durand"},{id:"h9",date:"2024-01-15T08:00:00",type:"affectation",description:"Affect\xe9 \xe0 Jean Dupont",auteur:"Pierre Durand"},{id:"h10",date:"2024-01-16T09:00:00",type:"statut",description:'Statut chang\xe9 vers "Bloqu\xe9"',auteur:"Jean Dupont"}],commentaires:[{id:"c3",signalement_id:"4",auteur:i[0],contenu:"En attente du v\xe9hicule de collecte, indisponible cette semaine.",date:"2024-01-16T09:05:00"}]},{id:"5",titre:"Banc cass\xe9 Square Gambetta",description:"Un des bancs du square a une latte cass\xe9e, risque de blessure.",categorie:"Mobilier urbain",statut:"nouveau",priorite:"basse",localisation:"Square Gambetta",photos:[],cree_par:i[1],assigne_a:null,date_creation:"2024-01-18T10:15:00",date_modification:"2024-01-18T10:15:00",historique:[{id:"h11",date:"2024-01-18T10:15:00",type:"creation",description:"Signalement cr\xe9\xe9",auteur:"Marie Martin"}],commentaires:[]},{id:"6",titre:"Graffitis sur l'abribus Gare",description:"Tags importants sur les vitres et parois de l'abribus devant la gare.",categorie:"Propret\xe9",statut:"en_cours",priorite:"basse",localisation:"Abribus - Place de la Gare",photos:["/placeholder-photo.jpg"],cree_par:i[0],assigne_a:i[1],date_creation:"2024-01-12T16:00:00",date_modification:"2024-01-17T11:30:00",historique:[{id:"h12",date:"2024-01-12T16:00:00",type:"creation",description:"Signalement cr\xe9\xe9",auteur:"Jean Dupont"},{id:"h13",date:"2024-01-17T11:30:00",type:"statut",description:'Statut chang\xe9 vers "En cours"',auteur:"Marie Martin"}],commentaires:[]}],c=(0,r.U)((e,s)=>({currentUser:null,login:t=>{let l=s().users.find(e=>e.email===t);return!!l&&(e({currentUser:l}),!0)},logout:()=>e({currentUser:null}),users:i,addUser:s=>{let t={...s,id:Date.now().toString()};e(e=>({users:[...e.users,t]}))},updateUser:(s,t)=>{e(e=>({users:e.users.map(e=>e.id===s?{...e,...t}:e)}))},deleteUser:s=>{e(e=>({users:e.users.filter(e=>e.id!==s)}))},signalements:o,addSignalement:t=>{let l=s().currentUser;if(!l)return;let a=new Date().toISOString(),r={...t,id:Date.now().toString(),date_creation:a,date_modification:a,historique:[{id:"h-".concat(Date.now()),date:a,type:"creation",description:"Signalement cr\xe9\xe9",auteur:l.nom}],commentaires:[]};e(e=>({signalements:[r,...e.signalements]}))},updateSignalementStatut:(t,l)=>{let a=s().currentUser;if(!a)return;let r=new Date().toISOString(),i={nouveau:"Nouveau",en_cours:"En cours",bloque:"Bloqu\xe9",resolu:"R\xe9solu"};e(e=>({signalements:e.signalements.map(e=>e.id===t?{...e,statut:l,date_modification:r,historique:[...e.historique,{id:"h-".concat(Date.now()),date:r,type:"statut",description:'Statut chang\xe9 vers "'.concat(i[l],'"'),auteur:a.nom}]}:e)}))},assignerSignalement:(t,l)=>{let a=s().currentUser,r=s().users;if(!a)return;let i=l?r.find(e=>e.id===l):null,n=new Date().toISOString();e(e=>({signalements:e.signalements.map(e=>e.id===t?{...e,assigne_a:i||null,date_modification:n,historique:[...e.historique,{id:"h-".concat(Date.now()),date:n,type:"affectation",description:i?"Affect\xe9 \xe0 ".concat(i.nom):"Affectation retir\xe9e",auteur:a.nom}]}:e)}))},addCommentaire:(t,l)=>{let a=s().currentUser;if(!a)return;let r=new Date().toISOString(),i={id:"c-".concat(Date.now()),signalement_id:t,auteur:a,contenu:l,date:r};e(e=>({signalements:e.signalements.map(e=>e.id===t?{...e,date_modification:r,commentaires:[...e.commentaires,i],historique:[...e.historique,{id:"h-".concat(Date.now()),date:r,type:"commentaire",description:"Commentaire ajout\xe9",auteur:a.nom}]}:e)}))},categories:n,addCategorie:s=>{let t={...s,id:Date.now().toString()};e(e=>({categories:[...e.categories,t]}))},updateCategorie:(s,t)=>{e(e=>({categories:e.categories.map(e=>e.id===s?{...e,...t}:e)}))},deleteCategorie:s=>{e(e=>({categories:e.categories.filter(e=>e.id!==s)}))}}));var d=t(2934),u=t(9322),x=t(3245),m=t(2489);let h=(0,a.createContext)(null);function b(e){let{children:s}=e,[t,r]=(0,a.useState)([]),i=(0,a.useCallback)(function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",t=Date.now().toString();r(l=>[...l,{id:t,message:e,type:s}]),setTimeout(()=>{r(e=>e.filter(e=>e.id!==t))},3e3)},[]),n=e=>{r(s=>s.filter(s=>s.id!==e))},o={success:d.Z,error:u.Z,info:x.Z},c={success:"bg-green-50 border-green-200 text-green-800",error:"bg-red-50 border-red-200 text-red-800",info:"bg-blue-50 border-blue-200 text-blue-800"},b={success:"text-green-500",error:"text-red-500",info:"text-blue-500"};return(0,l.jsxs)(h.Provider,{value:{showToast:i},children:[s,(0,l.jsx)("div",{className:"fixed bottom-4 right-4 z-50 space-y-2",children:t.map(e=>{let s=o[e.type];return(0,l.jsxs)("div",{className:"flex items-center gap-3 px-4 py-3 rounded-lg border shadow-lg animate-slide-in ".concat(c[e.type]),children:[(0,l.jsx)(s,{className:"w-5 h-5 flex-shrink-0 ".concat(b[e.type])}),(0,l.jsx)("p",{className:"text-sm font-medium",children:e.message}),(0,l.jsx)("button",{onClick:()=>n(e.id),className:"ml-2 p-1 hover:bg-black/5 rounded transition-colors",children:(0,l.jsx)(m.Z,{className:"w-4 h-4"})})]},e.id)})})]})}var p=t(8420),g=t(875),j=t(9090);function f(){let{users:e,login:s}=c(),[t,r]=(0,a.useState)(""),[i,n]=(0,a.useState)(""),o={agent:"Agent",responsable:"Responsable",admin:"Administrateur"};return(0,l.jsx)("div",{className:"min-h-screen bg-slate-100 flex items-center justify-center p-4",children:(0,l.jsxs)("div",{className:"bg-white rounded-xl shadow-lg max-w-md w-full p-8",children:[(0,l.jsxs)("div",{className:"text-center mb-8",children:[(0,l.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-blue-600 rounded-xl mb-4",children:(0,l.jsx)(p.Z,{className:"w-8 h-8 text-white"})}),(0,l.jsx)("h1",{className:"text-2xl font-bold text-slate-900",children:"MaVille Signale"}),(0,l.jsx)("p",{className:"text-slate-600 mt-2",children:"Gestion des signalements municipaux"})]}),(0,l.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),!t){n("Veuillez s\xe9lectionner un utilisateur");return}s(t)||n("Erreur de connexion")},className:"space-y-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Connexion simul\xe9e"}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsxs)("select",{value:t,onChange:e=>{r(e.target.value),n("")},className:"w-full px-4 py-3 border border-slate-300 rounded-lg appearance-none bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,l.jsx)("option",{value:"",children:"S\xe9lectionner un utilisateur..."}),e.map(e=>(0,l.jsxs)("option",{value:e.email,children:[e.nom," (",o[e.role],")"]},e.id))]}),(0,l.jsx)(g.Z,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400 pointer-events-none"})]})]}),i&&(0,l.jsx)("p",{className:"text-red-600 text-sm",children:i}),(0,l.jsxs)("button",{type:"submit",className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center justify-center gap-2",children:[(0,l.jsx)(j.Z,{className:"w-5 h-5"}),"Se connecter"]})]}),(0,l.jsx)("div",{className:"mt-8 pt-6 border-t border-slate-200",children:(0,l.jsx)("p",{className:"text-xs text-slate-500 text-center",children:"MVP de d\xe9monstration - Authentification simul\xe9e"})})]})})}var N=t(5466),v=t(6937),w=t(6215),y=t(8728),C=t(7692),k=t(8293);function _(e){let{currentPage:s,onNavigate:t}=e,{currentUser:r,logout:i,signalements:n}=c(),[o,d]=(0,a.useState)(!1),u=(0,a.useMemo)(()=>{if(!r)return{nouveaux:0,nonAssignes:0};let e=[...n];return"agent"===r.role&&(e=e.filter(e=>{var s;return(null===(s=e.assigne_a)||void 0===s?void 0:s.id)===r.id||e.cree_par.id===r.id})),{nouveaux:e.filter(e=>"nouveau"===e.statut).length,nonAssignes:e.filter(e=>!e.assigne_a&&"resolu"!==e.statut).length}},[n,r]);if(!r)return null;let x={agent:"Agent",responsable:"Responsable",admin:"Administrateur"},h=[{id:"dashboard",label:"Tableau de bord",icon:N.Z,roles:["agent","responsable","admin"],badge:u.nouveaux>0?u.nouveaux:null,badgeColor:"bg-blue-500"},{id:"nouveau",label:"Nouveau signalement",icon:v.Z,roles:["agent","responsable","admin"],badge:null,badgeColor:""},{id:"stats",label:"Statistiques",icon:w.Z,roles:["responsable","admin"],badge:null,badgeColor:""},{id:"admin",label:"Administration",icon:y.Z,roles:["admin"],badge:null,badgeColor:""}].filter(e=>e.roles.includes(r.role)),b=e=>{t(e),d(!1)},g=()=>(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"p-4 border-b border-slate-200",children:(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("div",{className:"w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center",children:(0,l.jsx)(p.Z,{className:"w-5 h-5 text-white"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"font-bold text-slate-900",children:"MaVille Signale"}),(0,l.jsx)("p",{className:"text-xs text-slate-500",children:"Gestion municipale"})]})]})}),(0,l.jsx)("nav",{className:"flex-1 p-4 space-y-1",children:h.map(e=>{let t=e.icon,a=s===e.id;return(0,l.jsxs)("button",{onClick:()=>b(e.id),className:"w-full flex items-center justify-between px-3 py-2.5 rounded-lg text-left transition-colors ".concat(a?"bg-blue-50 text-blue-700":"text-slate-600 hover:bg-slate-100"),children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)(t,{className:"w-5 h-5"}),(0,l.jsx)("span",{className:"font-medium",children:e.label})]}),e.badge&&e.badge>0&&(0,l.jsx)("span",{className:"px-2 py-0.5 text-xs font-bold text-white rounded-full ".concat(e.badgeColor),children:e.badge})]},e.id)})}),("responsable"===r.role||"admin"===r.role)&&u.nonAssignes>0&&(0,l.jsx)("div",{className:"mx-4 mb-4 p-3 bg-amber-50 border border-amber-200 rounded-lg",children:(0,l.jsxs)("p",{className:"text-xs font-medium text-amber-800",children:[u.nonAssignes," signalement",u.nonAssignes>1?"s":""," non assign\xe9",u.nonAssignes>1?"s":""]})}),(0,l.jsxs)("div",{className:"p-4 border-t border-slate-200",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,l.jsx)("div",{className:"w-10 h-10 bg-slate-200 rounded-full flex items-center justify-center",children:(0,l.jsx)("span",{className:"font-medium text-slate-600",children:r.nom.split(" ").map(e=>e[0]).join("")})}),(0,l.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,l.jsx)("p",{className:"font-medium text-slate-900 truncate",children:r.nom}),(0,l.jsx)("p",{className:"text-xs text-slate-500",children:x[r.role]})]})]}),(0,l.jsxs)("button",{onClick:i,className:"w-full flex items-center gap-2 px-3 py-2 text-slate-600 hover:bg-slate-100 rounded-lg transition-colors",children:[(0,l.jsx)(C.Z,{className:"w-4 h-4"}),(0,l.jsx)("span",{className:"text-sm",children:"D\xe9connexion"})]})]})]});return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"lg:hidden fixed top-0 left-0 right-0 h-16 bg-white border-b border-slate-200 z-40 flex items-center px-4",children:[(0,l.jsxs)("button",{onClick:()=>d(!0),className:"p-2 -ml-2 text-slate-600 hover:bg-slate-100 rounded-lg relative",children:[(0,l.jsx)(k.Z,{className:"w-6 h-6"}),u.nouveaux>0&&(0,l.jsx)("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-blue-500 text-white text-xs font-bold rounded-full flex items-center justify-center",children:u.nouveaux})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2 ml-3",children:[(0,l.jsx)(p.Z,{className:"w-6 h-6 text-blue-600"}),(0,l.jsx)("span",{className:"font-bold text-slate-900",children:"MaVille Signale"})]})]}),o&&(0,l.jsx)("div",{className:"lg:hidden fixed inset-0 bg-black/50 z-50",onClick:()=>d(!1)}),(0,l.jsxs)("div",{className:"lg:hidden fixed top-0 left-0 bottom-0 w-72 bg-white z-50 transform transition-transform ".concat(o?"translate-x-0":"-translate-x-full"),children:[(0,l.jsx)("button",{onClick:()=>d(!1),className:"absolute top-4 right-4 p-2 text-slate-600 hover:bg-slate-100 rounded-lg",children:(0,l.jsx)(m.Z,{className:"w-5 h-5"})}),(0,l.jsx)("div",{className:"h-full flex flex-col",children:(0,l.jsx)(g,{})})]}),(0,l.jsx)("div",{className:"hidden lg:flex fixed top-0 left-0 bottom-0 w-64 bg-white border-r border-slate-200 flex-col",children:(0,l.jsx)(g,{})})]})}var S=t(519),Z=t(1723),D=t(9227),T=t(6865),A=t(3577),q=t(3247),M=t(8842),P=t(407),E=t(5954),U=t(3774),R=t(2369);function z(e){let{onViewDetail:s}=e,{signalements:t,currentUser:r,categories:i,users:n}=c(),[o,x]=(0,a.useState)(""),[m,h]=(0,a.useState)("tous"),[b,p]=(0,a.useState)("tous"),[g,j]=(0,a.useState)("tous"),[f,N]=(0,a.useState)("tous"),[v,w]=(0,a.useState)("recent"),y=n.filter(e=>"agent"===e.role||"responsable"===e.role),C=(null==r?void 0:r.role)==="responsable"||(null==r?void 0:r.role)==="admin",k=(0,a.useMemo)(()=>{let e=[...t];return(null==r?void 0:r.role)==="agent"&&(e=e.filter(e=>{var s;return(null===(s=e.assigne_a)||void 0===s?void 0:s.id)===r.id||e.cree_par.id===r.id})),{total:e.length,nouveaux:e.filter(e=>"nouveau"===e.statut).length,enCours:e.filter(e=>"en_cours"===e.statut).length,bloques:e.filter(e=>"bloque"===e.statut).length,hautePriorite:e.filter(e=>"haute"===e.priorite&&"resolu"!==e.statut).length,nonAssignes:e.filter(e=>!e.assigne_a&&"resolu"!==e.statut).length}},[t,r]),_=(0,a.useMemo)(()=>{let e=[...t];if((null==r?void 0:r.role)==="agent"&&(e=e.filter(e=>{var s;return(null===(s=e.assigne_a)||void 0===s?void 0:s.id)===r.id||e.cree_par.id===r.id})),o){let s=o.toLowerCase();e=e.filter(e=>e.titre.toLowerCase().includes(s)||e.description.toLowerCase().includes(s)||e.localisation.toLowerCase().includes(s))}"tous"!==m&&(e=e.filter(e=>e.statut===m)),"tous"!==b&&(e=e.filter(e=>e.categorie===b)),"tous"!==g&&(e=e.filter(e=>e.priorite===g)),"tous"!==f&&(e="non_assigne"===f?e.filter(e=>!e.assigne_a):e.filter(e=>{var s;return(null===(s=e.assigne_a)||void 0===s?void 0:s.id)===f}));let s={haute:0,normale:1,basse:2},l={nouveau:0,en_cours:1,bloque:2,resolu:3};switch(v){case"recent":e.sort((e,s)=>new Date(s.date_creation).getTime()-new Date(e.date_creation).getTime());break;case"ancien":e.sort((e,s)=>new Date(e.date_creation).getTime()-new Date(s.date_creation).getTime());break;case"priorite":e.sort((e,t)=>s[e.priorite]-s[t.priorite]);break;case"statut":e.sort((e,s)=>l[e.statut]-l[s.statut])}return e},[t,r,o,m,b,g,f,v]),z={nouveau:{label:"Nouveau",color:"bg-blue-100 text-blue-700",icon:S.Z},en_cours:{label:"En cours",color:"bg-amber-100 text-amber-700",icon:Z.Z},bloque:{label:"Bloqu\xe9",color:"bg-red-100 text-red-700",icon:D.Z},resolu:{label:"R\xe9solu",color:"bg-green-100 text-green-700",icon:d.Z}},L={basse:{label:"Basse",color:"text-slate-500"},normale:{label:"Normale",color:"text-blue-600"},haute:{label:"Haute",color:"text-red-600"}},V=e=>{let s=new Date,t=new Date(e),l=Math.floor((s.getTime()-t.getTime())/864e5);return 0===l?"Aujourd'hui":1===l?"Hier":l<7?"".concat(l," jours"):l<30?"".concat(Math.floor(l/7)," sem."):"".concat(Math.floor(l/30)," mois")},B=e=>{let s=i.find(s=>s.nom===e);return(null==s?void 0:s.couleur)||"#6b7280"};return(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsx)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-2xl font-bold text-slate-900",children:"Tableau de bord"}),(0,l.jsx)("p",{className:"text-slate-600 mt-1",children:(null==r?void 0:r.role)==="agent"?"Vos signalements assign\xe9s et cr\xe9\xe9s":"Tous les signalements"})]})}),(0,l.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-3",children:[(0,l.jsxs)("button",{onClick:()=>{h("tous"),j("tous"),N("tous")},className:"bg-white rounded-xl border p-4 text-left transition-all hover:shadow-md ".concat("tous"===m&&"tous"===g&&"tous"===f?"border-blue-300 ring-2 ring-blue-100":"border-slate-200"),children:[(0,l.jsx)("p",{className:"text-2xl font-bold text-slate-900",children:k.total}),(0,l.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:"Total"})]}),(0,l.jsxs)("button",{onClick:()=>{h("nouveau"),j("tous"),N("tous")},className:"bg-white rounded-xl border p-4 text-left transition-all hover:shadow-md ".concat("nouveau"===m?"border-blue-300 ring-2 ring-blue-100":"border-slate-200"),children:[(0,l.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:k.nouveaux}),(0,l.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:"Nouveaux"})]}),(0,l.jsxs)("button",{onClick:()=>{h("en_cours"),j("tous"),N("tous")},className:"bg-white rounded-xl border p-4 text-left transition-all hover:shadow-md ".concat("en_cours"===m?"border-amber-300 ring-2 ring-amber-100":"border-slate-200"),children:[(0,l.jsx)("p",{className:"text-2xl font-bold text-amber-600",children:k.enCours}),(0,l.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:"En cours"})]}),(0,l.jsxs)("button",{onClick:()=>{h("bloque"),j("tous"),N("tous")},className:"bg-white rounded-xl border p-4 text-left transition-all hover:shadow-md ".concat("bloque"===m?"border-red-300 ring-2 ring-red-100":"border-slate-200"),children:[(0,l.jsx)("p",{className:"text-2xl font-bold text-red-600",children:k.bloques}),(0,l.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:"Bloqu\xe9s"})]}),(0,l.jsxs)("button",{onClick:()=>{h("tous"),j("haute"),N("tous")},className:"bg-white rounded-xl border p-4 text-left transition-all hover:shadow-md ".concat("haute"===g?"border-red-300 ring-2 ring-red-100":"border-slate-200"),children:[(0,l.jsxs)("div",{className:"flex items-center gap-1",children:[(0,l.jsx)(T.Z,{className:"w-4 h-4 text-red-500"}),(0,l.jsx)("p",{className:"text-2xl font-bold text-red-600",children:k.hautePriorite})]}),(0,l.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:"Urgents"})]}),C&&(0,l.jsxs)("button",{onClick:()=>{h("tous"),j("tous"),N("non_assigne")},className:"bg-white rounded-xl border p-4 text-left transition-all hover:shadow-md ".concat("non_assigne"===f?"border-amber-300 ring-2 ring-amber-100":"border-slate-200"),children:[(0,l.jsx)("p",{className:"text-2xl font-bold text-amber-600",children:k.nonAssignes}),(0,l.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:"Non assign\xe9s"})]})]}),(0,l.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 p-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(A.Z,{className:"w-4 h-4 text-slate-500"}),(0,l.jsx)("span",{className:"text-sm font-medium text-slate-700",children:"Filtres"})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[(0,l.jsx)("span",{className:"font-medium",children:_.length}),(0,l.jsxs)("span",{children:["r\xe9sultat",_.length>1?"s":""]})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4",children:[(0,l.jsxs)("div",{className:"relative lg:col-span-2",children:[(0,l.jsx)(q.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),(0,l.jsx)("input",{type:"text",placeholder:"Rechercher...",value:o,onChange:e=>x(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,l.jsxs)("select",{value:b,onChange:e=>p(e.target.value),className:"px-4 py-2 border border-slate-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white",children:[(0,l.jsx)("option",{value:"tous",children:"Toutes cat\xe9gories"}),i.map(e=>(0,l.jsx)("option",{value:e.nom,children:e.nom},e.id))]}),C&&(0,l.jsxs)("select",{value:f,onChange:e=>N(e.target.value),className:"px-4 py-2 border border-slate-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white",children:[(0,l.jsx)("option",{value:"tous",children:"Tous agents"}),(0,l.jsx)("option",{value:"non_assigne",children:"Non assign\xe9s"}),y.map(e=>(0,l.jsx)("option",{value:e.id,children:e.nom},e.id))]}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(M.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),(0,l.jsxs)("select",{value:v,onChange:e=>w(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white appearance-none",children:[(0,l.jsx)("option",{value:"recent",children:"Plus r\xe9cent"}),(0,l.jsx)("option",{value:"ancien",children:"Plus ancien"}),(0,l.jsx)("option",{value:"priorite",children:"Par priorit\xe9"}),(0,l.jsx)("option",{value:"statut",children:"Par statut"})]})]})]})]}),(0,l.jsx)("div",{className:"space-y-3",children:0===_.length?(0,l.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 p-8 text-center",children:[(0,l.jsx)(u.Z,{className:"w-12 h-12 text-slate-300 mx-auto mb-4"}),(0,l.jsx)("p",{className:"text-slate-600",children:"Aucun signalement trouv\xe9"}),(0,l.jsx)("p",{className:"text-sm text-slate-400 mt-1",children:"Essayez de modifier vos filtres"})]}):_.map(e=>{let t=z[e.statut],a=L[e.priorite],r=t.icon,i=V(e.date_creation),n=new Date().getTime()-new Date(e.date_creation).getTime()>6048e5;return(0,l.jsx)("button",{onClick:()=>s(e.id),className:"w-full bg-white rounded-xl border border-slate-200 p-4 hover:border-blue-300 hover:shadow-md transition-all text-left",children:(0,l.jsxs)("div",{className:"flex items-start gap-4",children:[(0,l.jsx)("div",{className:"w-1 h-full min-h-[80px] rounded-full flex-shrink-0",style:{backgroundColor:B(e.categorie)}}),(0,l.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,l.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"font-semibold text-slate-900 line-clamp-1",children:e.titre}),(0,l.jsx)("p",{className:"text-sm text-slate-600 mt-1 line-clamp-2",children:e.description})]}),(0,l.jsx)(P.Z,{className:"w-5 h-5 text-slate-400 flex-shrink-0"})]}),(0,l.jsxs)("div",{className:"flex flex-wrap items-center gap-3 mt-3",children:[(0,l.jsxs)("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium ".concat(t.color),children:[(0,l.jsx)(r,{className:"w-3.5 h-3.5"}),t.label]}),(0,l.jsx)("span",{className:"text-xs text-slate-600 bg-slate-100 px-2.5 py-1 rounded-full",children:e.categorie}),"haute"===e.priorite?(0,l.jsxs)("span",{className:"inline-flex items-center gap-1 text-xs font-medium text-red-600 bg-red-50 px-2 py-1 rounded-full",children:[(0,l.jsx)(T.Z,{className:"w-3 h-3"}),"Urgent"]}):(0,l.jsxs)("span",{className:"text-xs font-medium ".concat(a.color),children:["Priorit\xe9 ",a.label.toLowerCase()]}),(0,l.jsxs)("span",{className:"inline-flex items-center gap-1 text-xs ".concat(n&&"resolu"!==e.statut?"text-amber-600":"text-slate-500"),children:[(0,l.jsx)(E.Z,{className:"w-3.5 h-3.5"}),i]}),(0,l.jsxs)("span",{className:"inline-flex items-center gap-1 text-xs text-slate-500",children:[(0,l.jsx)(U.Z,{className:"w-3.5 h-3.5"}),e.localisation]}),e.assigne_a?(0,l.jsxs)("span",{className:"inline-flex items-center gap-1 text-xs text-slate-500",children:[(0,l.jsx)(R.Z,{className:"w-3.5 h-3.5"}),e.assigne_a.nom]}):(0,l.jsxs)("span",{className:"inline-flex items-center gap-1 text-xs text-amber-600 bg-amber-50 px-2 py-0.5 rounded",children:[(0,l.jsx)(R.Z,{className:"w-3.5 h-3.5"}),"Non assign\xe9"]})]})]})]})},e.id)})})]})}var L=t(401),V=t(3581),B=t(7689);function O(e){let{onSuccess:s}=e,{categories:t,currentUser:r,addSignalement:i}=c(),[n,o]=(0,a.useState)(""),[d,u]=(0,a.useState)(""),[x,h]=(0,a.useState)(""),[b,p]=(0,a.useState)("normale"),[g,j]=(0,a.useState)(""),[f,N]=(0,a.useState)([]),[v,w]=(0,a.useState)({}),[y,C]=(0,a.useState)(!1),k=()=>{let e={};return n.trim()||(e.titre="Le titre est requis"),d.trim()||(e.description="La description est requise"),x||(e.categorie="Veuillez s\xe9lectionner une cat\xe9gorie"),g.trim()||(e.localisation="La localisation est requise"),w(e),0===Object.keys(e).length},_=e=>{N(f.filter((s,t)=>t!==e))};return y?(0,l.jsx)("div",{className:"max-w-2xl mx-auto",children:(0,l.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 p-8 text-center",children:[(0,l.jsx)("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,l.jsx)(L.Z,{className:"w-8 h-8 text-green-600"})}),(0,l.jsx)("h2",{className:"text-xl font-bold text-slate-900 mb-2",children:"Signalement cr\xe9\xe9 avec succ\xe8s"}),(0,l.jsx)("p",{className:"text-slate-600",children:"Votre signalement a \xe9t\xe9 enregistr\xe9 et sera trait\xe9 prochainement."})]})}):(0,l.jsxs)("div",{className:"max-w-2xl mx-auto space-y-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-2xl font-bold text-slate-900",children:"Nouveau signalement"}),(0,l.jsx)("p",{className:"text-slate-600 mt-1",children:"Remplissez le formulaire pour cr\xe9er un nouveau signalement"})]}),(0,l.jsxs)("form",{onSubmit:e=>{e.preventDefault(),k()&&r&&(i({titre:n,description:d,categorie:x,statut:"nouveau",priorite:b,localisation:g,photos:f,cree_par:r,assigne_a:null}),C(!0),setTimeout(()=>{s()},1500))},className:"bg-white rounded-xl border border-slate-200 p-6 space-y-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Titre du signalement *"}),(0,l.jsx)("input",{type:"text",value:n,onChange:e=>o(e.target.value),placeholder:"Ex: Nid de poule rue de la Mairie",className:"w-full px-4 py-2.5 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent ".concat(v.titre?"border-red-300":"border-slate-300")}),v.titre&&(0,l.jsx)("p",{className:"mt-1 text-sm text-red-600",children:v.titre})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Description *"}),(0,l.jsx)("textarea",{value:d,onChange:e=>u(e.target.value),rows:4,placeholder:"D\xe9crivez le probl\xe8me en d\xe9tail...",className:"w-full px-4 py-2.5 border rounded-lg resize-none focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent ".concat(v.description?"border-red-300":"border-slate-300")}),v.description&&(0,l.jsx)("p",{className:"mt-1 text-sm text-red-600",children:v.description})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Cat\xe9gorie *"}),(0,l.jsxs)("select",{value:x,onChange:e=>h(e.target.value),className:"w-full px-4 py-2.5 border rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent ".concat(v.categorie?"border-red-300":"border-slate-300"),children:[(0,l.jsx)("option",{value:"",children:"S\xe9lectionner..."}),t.map(e=>(0,l.jsx)("option",{value:e.nom,children:e.nom},e.id))]}),v.categorie&&(0,l.jsx)("p",{className:"mt-1 text-sm text-red-600",children:v.categorie})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Priorit\xe9"}),(0,l.jsx)("div",{className:"flex gap-2",children:["basse","normale","haute"].map(e=>(0,l.jsxs)("button",{type:"button",onClick:()=>p(e),className:"flex-1 px-3 py-2.5 rounded-lg text-sm font-medium transition-colors ".concat(b===e?"haute"===e?"bg-red-100 text-red-700 border-2 border-red-300":"normale"===e?"bg-blue-100 text-blue-700 border-2 border-blue-300":"bg-slate-100 text-slate-700 border-2 border-slate-300":"bg-slate-50 text-slate-600 border border-slate-200 hover:bg-slate-100"),children:["haute"===e&&(0,l.jsx)(T.Z,{className:"w-4 h-4 inline mr-1"}),e.charAt(0).toUpperCase()+e.slice(1)]},e))})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Localisation *"}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(U.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),(0,l.jsx)("input",{type:"text",value:g,onChange:e=>j(e.target.value),placeholder:"Adresse ou description du lieu",className:"w-full pl-10 pr-4 py-2.5 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent ".concat(v.localisation?"border-red-300":"border-slate-300")})]}),v.localisation&&(0,l.jsx)("p",{className:"mt-1 text-sm text-red-600",children:v.localisation})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Photos (optionnel)"}),(0,l.jsxs)("div",{className:"space-y-3",children:[f.length>0&&(0,l.jsx)("div",{className:"flex flex-wrap gap-3",children:f.map((e,s)=>(0,l.jsxs)("div",{className:"relative w-24 h-24 bg-slate-100 rounded-lg overflow-hidden",children:[(0,l.jsx)("div",{className:"w-full h-full flex items-center justify-center text-slate-400",children:(0,l.jsx)(V.Z,{className:"w-8 h-8"})}),(0,l.jsx)("button",{type:"button",onClick:()=>_(s),className:"absolute top-1 right-1 w-6 h-6 bg-red-500 text-white rounded-full flex items-center justify-center hover:bg-red-600",children:(0,l.jsx)(m.Z,{className:"w-4 h-4"})})]},s))}),(0,l.jsxs)("button",{type:"button",onClick:()=>{let e=["/placeholder-photo-1.jpg","/placeholder-photo-2.jpg","/placeholder-photo-3.jpg"];N([...f,e[Math.floor(Math.random()*e.length)]])},className:"flex items-center gap-2 px-4 py-2.5 border border-dashed border-slate-300 rounded-lg text-slate-600 hover:bg-slate-50 transition-colors",children:[(0,l.jsx)(B.Z,{className:"w-5 h-5"}),(0,l.jsx)("span",{children:"Ajouter une photo (simul\xe9)"})]}),(0,l.jsx)("p",{className:"text-xs text-slate-500",children:"Note: Dans cette version MVP, l'ajout de photos est simul\xe9."})]})]}),(0,l.jsx)("div",{className:"flex justify-end gap-3 pt-4 border-t border-slate-200",children:(0,l.jsx)("button",{type:"submit",className:"px-6 py-2.5 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors",children:"Cr\xe9er le signalement"})})]})]})}var J=t(2660),G=t(4743),I=t(5621);function H(e){var s,t;let{signalementId:r,onBack:i}=e,{signalements:n,currentUser:o,users:x,updateSignalementStatut:m,assignerSignalement:h,addCommentaire:b}=c(),[p,g]=(0,a.useState)(""),j=n.find(e=>e.id===r);if(!j)return(0,l.jsxs)("div",{className:"text-center py-12",children:[(0,l.jsx)(u.Z,{className:"w-12 h-12 text-slate-300 mx-auto mb-4"}),(0,l.jsx)("p",{className:"text-slate-600",children:"Signalement non trouv\xe9"}),(0,l.jsx)("button",{onClick:i,className:"mt-4 text-blue-600 hover:underline",children:"Retour au tableau de bord"})]});let f=(null==o?void 0:o.role)==="responsable"||(null==o?void 0:o.role)==="admin"||(null===(s=j.assigne_a)||void 0===s?void 0:s.id)===(null==o?void 0:o.id),N=(null==o?void 0:o.role)==="responsable"||(null==o?void 0:o.role)==="admin",v={nouveau:{label:"Nouveau",color:"text-blue-700",bgColor:"bg-blue-100",icon:S.Z},en_cours:{label:"En cours",color:"text-amber-700",bgColor:"bg-amber-100",icon:Z.Z},bloque:{label:"Bloqu\xe9",color:"text-red-700",bgColor:"bg-red-100",icon:D.Z},resolu:{label:"R\xe9solu",color:"text-green-700",bgColor:"bg-green-100",icon:d.Z}},w=e=>new Date(e).toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}),y=()=>{p.trim()&&(b(j.id,p),g(""))},C=x.filter(e=>"agent"===e.role||"responsable"===e.role),k=v[j.statut],_=k.icon;return(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsx)("button",{onClick:i,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:(0,l.jsx)(J.Z,{className:"w-5 h-5 text-slate-600"})}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("h1",{className:"text-xl font-bold text-slate-900 line-clamp-1",children:j.titre}),(0,l.jsxs)("p",{className:"text-sm text-slate-500 mt-1",children:["Signalement #",j.id]})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,l.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,l.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[(0,l.jsx)("h2",{className:"font-semibold text-slate-900 mb-4",children:"Informations"}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-slate-500",children:"Description"}),(0,l.jsx)("p",{className:"mt-1 text-slate-900",children:j.description})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-slate-500",children:"Cat\xe9gorie"}),(0,l.jsx)("p",{className:"mt-1 text-slate-900",children:j.categorie})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-slate-500",children:"Priorit\xe9"}),(0,l.jsx)("p",{className:"mt-1 font-medium ".concat("haute"===j.priorite?"text-red-600":"normale"===j.priorite?"text-blue-600":"text-slate-600"),children:{basse:"Basse",normale:"Normale",haute:"Haute"}[j.priorite]})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"text-sm text-slate-500 flex items-center gap-1",children:[(0,l.jsx)(U.Z,{className:"w-4 h-4"}),"Localisation"]}),(0,l.jsx)("p",{className:"mt-1 text-slate-900",children:j.localisation})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-slate-500",children:"Cr\xe9\xe9 par"}),(0,l.jsx)("p",{className:"mt-1 text-slate-900",children:j.cree_par.nom})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-slate-500",children:"Date de cr\xe9ation"}),(0,l.jsx)("p",{className:"mt-1 text-slate-900",children:w(j.date_creation)})]})]})]}),j.photos.length>0&&(0,l.jsxs)("div",{className:"mt-6 pt-6 border-t border-slate-200",children:[(0,l.jsx)("label",{className:"text-sm text-slate-500 mb-3 block",children:"Photos"}),(0,l.jsx)("div",{className:"flex flex-wrap gap-3",children:j.photos.map((e,s)=>(0,l.jsx)("div",{className:"w-32 h-32 bg-slate-100 rounded-lg flex items-center justify-center text-slate-400",children:(0,l.jsx)(V.Z,{className:"w-8 h-8"})},s))})]})]}),(0,l.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[(0,l.jsxs)("h2",{className:"font-semibold text-slate-900 mb-4",children:["Commentaires (",j.commentaires.length,")"]}),(0,l.jsxs)("div",{className:"space-y-4",children:[0===j.commentaires.length?(0,l.jsx)("p",{className:"text-slate-500 text-sm",children:"Aucun commentaire pour le moment"}):j.commentaires.map(e=>(0,l.jsxs)("div",{className:"flex gap-3",children:[(0,l.jsx)("div",{className:"w-8 h-8 bg-slate-200 rounded-full flex items-center justify-center flex-shrink-0",children:(0,l.jsx)("span",{className:"text-xs font-medium text-slate-600",children:e.auteur.nom.split(" ").map(e=>e[0]).join("")})}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("span",{className:"font-medium text-slate-900 text-sm",children:e.auteur.nom}),(0,l.jsx)("span",{className:"text-xs text-slate-500",children:w(e.date)})]}),(0,l.jsx)("p",{className:"mt-1 text-slate-700 text-sm",children:e.contenu})]})]},e.id)),(0,l.jsxs)("div",{className:"flex gap-3 pt-4 border-t border-slate-200",children:[(0,l.jsx)("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:(0,l.jsx)("span",{className:"text-xs font-medium text-blue-600",children:null==o?void 0:o.nom.split(" ").map(e=>e[0]).join("")})}),(0,l.jsxs)("div",{className:"flex-1 flex gap-2",children:[(0,l.jsx)("input",{type:"text",value:p,onChange:e=>g(e.target.value),placeholder:"Ajouter un commentaire...",className:"flex-1 px-3 py-2 border border-slate-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",onKeyPress:e=>"Enter"===e.key&&y()}),(0,l.jsx)("button",{onClick:y,disabled:!p.trim(),className:"px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:(0,l.jsx)(G.Z,{className:"w-4 h-4"})})]})]})]})]})]}),(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[(0,l.jsx)("h2",{className:"font-semibold text-slate-900 mb-4",children:"Statut"}),(0,l.jsxs)("div",{className:"inline-flex items-center gap-2 px-3 py-2 rounded-lg ".concat(k.bgColor," ").concat(k.color," mb-4"),children:[(0,l.jsx)(_,{className:"w-5 h-5"}),(0,l.jsx)("span",{className:"font-medium",children:k.label})]}),f&&(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("label",{className:"text-sm text-slate-500",children:"Changer le statut"}),(0,l.jsx)("div",{className:"grid grid-cols-2 gap-2",children:Object.keys(v).map(e=>{let s=v[e],t=s.icon;return(0,l.jsxs)("button",{onClick:()=>m(j.id,e),disabled:j.statut===e,className:"flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-colors ".concat(j.statut===e?"".concat(s.bgColor," ").concat(s.color):"bg-slate-50 text-slate-600 hover:bg-slate-100"),children:[(0,l.jsx)(t,{className:"w-4 h-4"}),s.label]},e)})})]})]}),(0,l.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[(0,l.jsx)("h2",{className:"font-semibold text-slate-900 mb-4",children:"Affectation"}),j.assigne_a?(0,l.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,l.jsx)("div",{className:"w-10 h-10 bg-slate-200 rounded-full flex items-center justify-center",children:(0,l.jsx)(R.Z,{className:"w-5 h-5 text-slate-600"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"font-medium text-slate-900",children:j.assigne_a.nom}),(0,l.jsx)("p",{className:"text-sm text-slate-500 capitalize",children:j.assigne_a.role})]})]}):(0,l.jsx)("p",{className:"text-slate-500 text-sm mb-4",children:"Non assign\xe9"}),N&&(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-slate-500 block mb-2",children:j.assigne_a?"R\xe9affecter \xe0":"Affecter \xe0"}),(0,l.jsxs)("select",{value:(null===(t=j.assigne_a)||void 0===t?void 0:t.id)||"",onChange:e=>h(j.id,e.target.value||null),className:"w-full px-3 py-2 border border-slate-300 rounded-lg text-sm bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,l.jsx)("option",{value:"",children:"Non assign\xe9"}),C.map(e=>(0,l.jsxs)("option",{value:e.id,children:[e.nom," (",e.role,")"]},e.id))]})]})]}),(0,l.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[(0,l.jsxs)("h2",{className:"font-semibold text-slate-900 mb-4 flex items-center gap-2",children:[(0,l.jsx)(I.Z,{className:"w-5 h-5"}),"Historique"]}),(0,l.jsx)("div",{className:"space-y-3",children:j.historique.map((e,s)=>(0,l.jsxs)("div",{className:"flex gap-3",children:[(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("div",{className:"w-2 h-2 bg-slate-300 rounded-full mt-2"}),s<j.historique.length-1&&(0,l.jsx)("div",{className:"absolute top-4 left-[3px] w-0.5 h-full bg-slate-200"})]}),(0,l.jsxs)("div",{className:"flex-1 pb-3",children:[(0,l.jsx)("p",{className:"text-sm text-slate-900",children:e.description}),(0,l.jsxs)("p",{className:"text-xs text-slate-500 mt-1",children:[e.auteur," - ",w(e.date)]})]})]},e.id))})]})]})]})]})}var F=t(525),K=t(5805);function Q(){let{signalements:e,categories:s,users:t}=c(),r=(0,a.useMemo)(()=>{let l=e.length,a={nouveau:0,en_cours:0,bloque:0,resolu:0};e.forEach(e=>{a[e.statut]++});let r={};s.forEach(e=>{r[e.nom]=0}),e.forEach(e=>{void 0!==r[e.categorie]&&r[e.categorie]++});let i={haute:e.filter(e=>"haute"===e.priorite).length,normale:e.filter(e=>"normale"===e.priorite).length,basse:e.filter(e=>"basse"===e.priorite).length},n={};t.filter(e=>"agent"===e.role).forEach(s=>{n[s.nom]=e.filter(e=>{var t;return(null===(t=e.assigne_a)||void 0===t?void 0:t.id)===s.id}).length});let o=l>0?Math.round(a.resolu/l*100):0;return{total:l,byStatut:a,byCategorie:r,byPriorite:i,byAgent:n,tauxResolution:o,nonAssignes:e.filter(e=>!e.assigne_a).length}},[e,s,t]),i={nouveau:{label:"Nouveaux",color:"bg-blue-500",icon:S.Z},en_cours:{label:"En cours",color:"bg-amber-500",icon:Z.Z},bloque:{label:"Bloqu\xe9s",color:"bg-red-500",icon:D.Z},resolu:{label:"R\xe9solus",color:"bg-green-500",icon:d.Z}},n=(e,s)=>s>0?e/s*100:0,o=Math.max(...Object.values(r.byCategorie),1),u=Math.max(...Object.values(r.byAgent),1);return(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-2xl font-bold text-slate-900",children:"Statistiques"}),(0,l.jsx)("p",{className:"text-slate-600 mt-1",children:"Vue d'ensemble des signalements"})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,l.jsx)("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-slate-500",children:"Total signalements"}),(0,l.jsx)("p",{className:"text-3xl font-bold text-slate-900 mt-1",children:r.total})]}),(0,l.jsx)("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center",children:(0,l.jsx)(w.Z,{className:"w-6 h-6 text-blue-600"})})]})}),(0,l.jsx)("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-slate-500",children:"Taux de r\xe9solution"}),(0,l.jsxs)("p",{className:"text-3xl font-bold text-green-600 mt-1",children:[r.tauxResolution,"%"]})]}),(0,l.jsx)("div",{className:"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center",children:(0,l.jsx)(F.Z,{className:"w-6 h-6 text-green-600"})})]})}),(0,l.jsx)("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-slate-500",children:"Priorit\xe9 haute"}),(0,l.jsx)("p",{className:"text-3xl font-bold text-red-600 mt-1",children:r.byPriorite.haute})]}),(0,l.jsx)("div",{className:"w-12 h-12 bg-red-100 rounded-xl flex items-center justify-center",children:(0,l.jsx)(T.Z,{className:"w-6 h-6 text-red-600"})})]})}),(0,l.jsx)("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-slate-500",children:"Non assign\xe9s"}),(0,l.jsx)("p",{className:"text-3xl font-bold text-amber-600 mt-1",children:r.nonAssignes})]}),(0,l.jsx)("div",{className:"w-12 h-12 bg-amber-100 rounded-xl flex items-center justify-center",children:(0,l.jsx)(K.Z,{className:"w-6 h-6 text-amber-600"})})]})})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,l.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[(0,l.jsx)("h2",{className:"font-semibold text-slate-900 mb-6",children:"R\xe9partition par statut"}),(0,l.jsx)("div",{className:"space-y-4",children:Object.keys(i).map(e=>{let s=i[e],t=r.byStatut[e],a=r.total>0?Math.round(t/r.total*100):0,n=s.icon;return(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(n,{className:"w-4 h-4 text-slate-500"}),(0,l.jsx)("span",{className:"text-sm font-medium text-slate-700",children:s.label})]}),(0,l.jsxs)("div",{className:"text-sm text-slate-600",children:[(0,l.jsx)("span",{className:"font-semibold",children:t}),(0,l.jsxs)("span",{className:"text-slate-400 ml-1",children:["(",a,"%)"]})]})]}),(0,l.jsx)("div",{className:"h-3 bg-slate-100 rounded-full overflow-hidden",children:(0,l.jsx)("div",{className:"h-full ".concat(s.color," rounded-full transition-all duration-500"),style:{width:"".concat(a,"%")}})})]},e)})})]}),(0,l.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[(0,l.jsx)("h2",{className:"font-semibold text-slate-900 mb-6",children:"R\xe9partition par cat\xe9gorie"}),(0,l.jsx)("div",{className:"space-y-4",children:s.map(e=>{let s=r.byCategorie[e.nom]||0;return(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:e.couleur}}),(0,l.jsx)("span",{className:"text-sm font-medium text-slate-700",children:e.nom})]}),(0,l.jsx)("span",{className:"text-sm font-semibold text-slate-600",children:s})]}),(0,l.jsx)("div",{className:"h-3 bg-slate-100 rounded-full overflow-hidden",children:(0,l.jsx)("div",{className:"h-full rounded-full transition-all duration-500",style:{width:"".concat(n(s,o),"%"),backgroundColor:e.couleur}})})]},e.id)})})]}),(0,l.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[(0,l.jsx)("h2",{className:"font-semibold text-slate-900 mb-6",children:"R\xe9partition par priorit\xe9"}),(0,l.jsx)("div",{className:"flex items-end justify-center gap-8 h-48",children:[{key:"haute",label:"Haute",color:"bg-red-500",value:r.byPriorite.haute},{key:"normale",label:"Normale",color:"bg-blue-500",value:r.byPriorite.normale},{key:"basse",label:"Basse",color:"bg-slate-400",value:r.byPriorite.basse}].map(e=>{let s=Math.max(r.byPriorite.haute,r.byPriorite.normale,r.byPriorite.basse,1),t=e.value/s*100;return(0,l.jsxs)("div",{className:"flex flex-col items-center",children:[(0,l.jsx)("span",{className:"text-sm font-semibold text-slate-700 mb-2",children:e.value}),(0,l.jsx)("div",{className:"w-16 ".concat(e.color," rounded-t-lg transition-all duration-500"),style:{height:"".concat(Math.max(t,10),"%")}}),(0,l.jsx)("span",{className:"text-xs text-slate-500 mt-2",children:e.label})]},e.key)})})]}),(0,l.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[(0,l.jsx)("h2",{className:"font-semibold text-slate-900 mb-6",children:"Signalements par agent"}),(0,l.jsx)("div",{className:"space-y-4",children:Object.entries(r.byAgent).map(e=>{let[s,t]=e;return(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"w-8 h-8 bg-slate-200 rounded-full flex items-center justify-center",children:(0,l.jsx)("span",{className:"text-xs font-medium text-slate-600",children:s.split(" ").map(e=>e[0]).join("")})}),(0,l.jsx)("span",{className:"text-sm font-medium text-slate-700",children:s})]}),(0,l.jsx)("span",{className:"text-sm font-semibold text-slate-600",children:t})]}),(0,l.jsx)("div",{className:"h-3 bg-slate-100 rounded-full overflow-hidden",children:(0,l.jsx)("div",{className:"h-full bg-blue-500 rounded-full transition-all duration-500",style:{width:"".concat(n(t,u),"%")}})})]},s)})})]})]})]})}var W=t(2720),X=t(9397),Y=t(8893),$=t(8930);function ee(e){let{isOpen:s,title:t,message:a,confirmLabel:r="Confirmer",cancelLabel:i="Annuler",variant:n="danger",onConfirm:o,onCancel:c}=e;if(!s)return null;let d={danger:{icon:"bg-red-100 text-red-600",button:"bg-red-600 hover:bg-red-700"},warning:{icon:"bg-amber-100 text-amber-600",button:"bg-amber-600 hover:bg-amber-700"},info:{icon:"bg-blue-100 text-blue-600",button:"bg-blue-600 hover:bg-blue-700"}};return(0,l.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:(0,l.jsxs)("div",{className:"bg-white rounded-xl max-w-sm w-full p-6 animate-scale-in",children:[(0,l.jsxs)("div",{className:"flex items-start gap-4",children:[(0,l.jsx)("div",{className:"w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0 ".concat(d[n].icon),children:(0,l.jsx)(T.Z,{className:"w-5 h-5"})}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("h3",{className:"font-semibold text-slate-900",children:t}),(0,l.jsx)("p",{className:"text-sm text-slate-600 mt-1",children:a})]}),(0,l.jsx)("button",{onClick:c,className:"p-1 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded transition-colors",children:(0,l.jsx)(m.Z,{className:"w-5 h-5"})})]}),(0,l.jsxs)("div",{className:"flex justify-end gap-3 mt-6",children:[(0,l.jsx)("button",{onClick:c,className:"px-4 py-2 text-slate-600 hover:bg-slate-100 rounded-lg transition-colors",children:i}),(0,l.jsx)("button",{onClick:o,className:"px-4 py-2 text-white rounded-lg transition-colors ".concat(d[n].button),children:r})]})]})})}function es(){let{users:e,categories:s,currentUser:t,addUser:r,updateUser:i,deleteUser:n,addCategorie:o,updateCategorie:d,deleteCategorie:x}=c(),{showToast:b}=function(){let e=(0,a.useContext)(h);if(!e)throw Error("useToast must be used within a ToastProvider");return e}(),[p,g]=(0,a.useState)("users"),[j,f]=(0,a.useState)(!1),[N,v]=(0,a.useState)(!1),[w,y]=(0,a.useState)(null),[C,k]=(0,a.useState)(null),[_,S]=(0,a.useState)(null),[Z,D]=(0,a.useState)(!1),[T,A]=(0,a.useState)({nom:"",email:"",role:"agent"}),[q,M]=(0,a.useState)({nom:"",description:"",couleur:"#3b82f6"}),P={agent:"Agent",responsable:"Responsable",admin:"Administrateur"},E=e=>{e?(y(e),A({nom:e.nom,email:e.email,role:e.role})):(y(null),A({nom:"",email:"",role:"agent"})),f(!0)},U=e=>{e?(k(e),M({nom:e.nom,description:e.description,couleur:e.couleur})):(k(null),M({nom:"",description:"",couleur:"#3b82f6"})),v(!0)},R=(e,s)=>{if(e===(null==t?void 0:t.id)){D(!0);return}S({type:"user",id:e,name:s})},z=(e,s)=>{S({type:"categorie",id:e,name:s})};return(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-2xl font-bold text-slate-900",children:"Administration"}),(0,l.jsx)("p",{className:"text-slate-600 mt-1",children:"Gestion des utilisateurs et cat\xe9gories"})]}),(0,l.jsxs)("div",{className:"flex gap-2 border-b border-slate-200",children:[(0,l.jsxs)("button",{onClick:()=>g("users"),className:"flex items-center gap-2 px-4 py-3 font-medium text-sm border-b-2 transition-colors ".concat("users"===p?"border-blue-600 text-blue-600":"border-transparent text-slate-600 hover:text-slate-900"),children:[(0,l.jsx)(K.Z,{className:"w-4 h-4"}),"Utilisateurs (",e.length,")"]}),(0,l.jsxs)("button",{onClick:()=>g("categories"),className:"flex items-center gap-2 px-4 py-3 font-medium text-sm border-b-2 transition-colors ".concat("categories"===p?"border-blue-600 text-blue-600":"border-transparent text-slate-600 hover:text-slate-900"),children:[(0,l.jsx)(W.Z,{className:"w-4 h-4"}),"Cat\xe9gories (",s.length,")"]})]}),"users"===p&&(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("div",{className:"flex justify-end",children:(0,l.jsxs)("button",{onClick:()=>E(),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[(0,l.jsx)(X.Z,{className:"w-4 h-4"}),"Ajouter un utilisateur"]})}),(0,l.jsx)("div",{className:"bg-white rounded-xl border border-slate-200 overflow-hidden",children:(0,l.jsxs)("table",{className:"w-full",children:[(0,l.jsx)("thead",{className:"bg-slate-50 border-b border-slate-200",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"text-left px-6 py-3 text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Utilisateur"}),(0,l.jsx)("th",{className:"text-left px-6 py-3 text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Email"}),(0,l.jsx)("th",{className:"text-left px-6 py-3 text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"R\xf4le"}),(0,l.jsx)("th",{className:"text-right px-6 py-3 text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Actions"})]})}),(0,l.jsx)("tbody",{className:"divide-y divide-slate-200",children:e.map(e=>(0,l.jsxs)("tr",{className:"hover:bg-slate-50",children:[(0,l.jsx)("td",{className:"px-6 py-4",children:(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("div",{className:"w-10 h-10 bg-slate-200 rounded-full flex items-center justify-center",children:(0,l.jsx)("span",{className:"text-sm font-medium text-slate-600",children:e.nom.split(" ").map(e=>e[0]).join("")})}),(0,l.jsx)("span",{className:"font-medium text-slate-900",children:e.nom}),e.id===(null==t?void 0:t.id)&&(0,l.jsx)("span",{className:"text-xs bg-blue-100 text-blue-700 px-2 py-0.5 rounded-full",children:"Vous"})]})}),(0,l.jsx)("td",{className:"px-6 py-4 text-slate-600",children:e.email}),(0,l.jsx)("td",{className:"px-6 py-4",children:(0,l.jsx)("span",{className:"px-2.5 py-1 rounded-full text-xs font-medium ".concat("admin"===e.role?"bg-purple-100 text-purple-700":"responsable"===e.role?"bg-amber-100 text-amber-700":"bg-slate-100 text-slate-700"),children:P[e.role]})}),(0,l.jsx)("td",{className:"px-6 py-4 text-right",children:(0,l.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,l.jsx)("button",{onClick:()=>E(e),className:"p-2 text-slate-500 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:(0,l.jsx)(Y.Z,{className:"w-4 h-4"})}),(0,l.jsx)("button",{onClick:()=>R(e.id,e.nom),disabled:e.id===(null==t?void 0:t.id),className:"p-2 text-slate-500 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-30 disabled:cursor-not-allowed",children:(0,l.jsx)($.Z,{className:"w-4 h-4"})})]})})]},e.id))})]})})]}),"categories"===p&&(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("div",{className:"flex justify-end",children:(0,l.jsxs)("button",{onClick:()=>U(),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[(0,l.jsx)(X.Z,{className:"w-4 h-4"}),"Ajouter une cat\xe9gorie"]})}),(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:s.map(e=>(0,l.jsx)("div",{className:"bg-white rounded-xl border border-slate-200 p-4",children:(0,l.jsxs)("div",{className:"flex items-start justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("div",{className:"w-10 h-10 rounded-lg",style:{backgroundColor:e.couleur}}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"font-semibold text-slate-900",children:e.nom}),(0,l.jsx)("p",{className:"text-sm text-slate-500 mt-0.5",children:e.description})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-1",children:[(0,l.jsx)("button",{onClick:()=>U(e),className:"p-2 text-slate-500 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:(0,l.jsx)(Y.Z,{className:"w-4 h-4"})}),(0,l.jsx)("button",{onClick:()=>z(e.id,e.nom),className:"p-2 text-slate-500 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:(0,l.jsx)($.Z,{className:"w-4 h-4"})})]})]})},e.id))})]}),j&&(0,l.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:(0,l.jsxs)("div",{className:"bg-white rounded-xl max-w-md w-full p-6 animate-scale-in",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,l.jsx)("h2",{className:"text-lg font-bold text-slate-900",children:w?"Modifier l'utilisateur":"Nouvel utilisateur"}),(0,l.jsx)("button",{onClick:()=>f(!1),className:"p-2 text-slate-500 hover:bg-slate-100 rounded-lg",children:(0,l.jsx)(m.Z,{className:"w-5 h-5"})})]}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Nom"}),(0,l.jsx)("input",{type:"text",value:T.nom,onChange:e=>A({...T,nom:e.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Jean Dupont"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Email"}),(0,l.jsx)("input",{type:"email",value:T.email,onChange:e=>A({...T,email:e.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"jean.dupont@ville.fr"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"R\xf4le"}),(0,l.jsxs)("select",{value:T.role,onChange:e=>A({...T,role:e.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,l.jsx)("option",{value:"agent",children:"Agent"}),(0,l.jsx)("option",{value:"responsable",children:"Responsable"}),(0,l.jsx)("option",{value:"admin",children:"Administrateur"})]})]})]}),(0,l.jsxs)("div",{className:"flex justify-end gap-3 mt-6",children:[(0,l.jsx)("button",{onClick:()=>f(!1),className:"px-4 py-2 text-slate-600 hover:bg-slate-100 rounded-lg transition-colors",children:"Annuler"}),(0,l.jsxs)("button",{onClick:()=>{T.nom.trim()&&T.email.trim()&&(w?(i(w.id,T),b("Utilisateur modifi\xe9 avec succ\xe8s")):(r(T),b("Utilisateur cr\xe9\xe9 avec succ\xe8s")),f(!1))},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[(0,l.jsx)(L.Z,{className:"w-4 h-4"}),w?"Enregistrer":"Cr\xe9er"]})]})]})}),N&&(0,l.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:(0,l.jsxs)("div",{className:"bg-white rounded-xl max-w-md w-full p-6 animate-scale-in",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,l.jsx)("h2",{className:"text-lg font-bold text-slate-900",children:C?"Modifier la cat\xe9gorie":"Nouvelle cat\xe9gorie"}),(0,l.jsx)("button",{onClick:()=>v(!1),className:"p-2 text-slate-500 hover:bg-slate-100 rounded-lg",children:(0,l.jsx)(m.Z,{className:"w-5 h-5"})})]}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Nom"}),(0,l.jsx)("input",{type:"text",value:q.nom,onChange:e=>M({...q,nom:e.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Voirie"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Description"}),(0,l.jsx)("textarea",{value:q.description,onChange:e=>M({...q,description:e.target.value}),rows:2,className:"w-full px-3 py-2 border border-slate-300 rounded-lg resize-none focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Description de la cat\xe9gorie..."})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Couleur"}),(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("input",{type:"color",value:q.couleur,onChange:e=>M({...q,couleur:e.target.value}),className:"w-12 h-10 rounded cursor-pointer border border-slate-300"}),(0,l.jsx)("input",{type:"text",value:q.couleur,onChange:e=>M({...q,couleur:e.target.value}),className:"flex-1 px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})]}),(0,l.jsxs)("div",{className:"flex justify-end gap-3 mt-6",children:[(0,l.jsx)("button",{onClick:()=>v(!1),className:"px-4 py-2 text-slate-600 hover:bg-slate-100 rounded-lg transition-colors",children:"Annuler"}),(0,l.jsxs)("button",{onClick:()=>{q.nom.trim()&&(C?(d(C.id,q),b("Cat\xe9gorie modifi\xe9e avec succ\xe8s")):(o(q),b("Cat\xe9gorie cr\xe9\xe9e avec succ\xe8s")),v(!1))},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[(0,l.jsx)(L.Z,{className:"w-4 h-4"}),C?"Enregistrer":"Cr\xe9er"]})]})]})}),(0,l.jsx)(ee,{isOpen:!!_,title:(null==_?void 0:_.type)==="user"?"Supprimer l'utilisateur":"Supprimer la cat\xe9gorie",message:"\xcates-vous s\xfbr de vouloir supprimer ".concat((null==_?void 0:_.type)==="user"?"l'utilisateur":"la cat\xe9gorie",' "').concat(null==_?void 0:_.name,'" ? Cette action est irr\xe9versible.'),confirmLabel:"Supprimer",variant:"danger",onConfirm:()=>{_&&("user"===_.type?(n(_.id),b("Utilisateur supprim\xe9")):(x(_.id),b("Cat\xe9gorie supprim\xe9e")),S(null))},onCancel:()=>S(null)}),Z&&(0,l.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:(0,l.jsxs)("div",{className:"bg-white rounded-xl max-w-sm w-full p-6 animate-scale-in",children:[(0,l.jsxs)("div",{className:"flex items-start gap-4",children:[(0,l.jsx)("div",{className:"w-10 h-10 rounded-full bg-amber-100 flex items-center justify-center flex-shrink-0",children:(0,l.jsx)(u.Z,{className:"w-5 h-5 text-amber-600"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"font-semibold text-slate-900",children:"Action impossible"}),(0,l.jsx)("p",{className:"text-sm text-slate-600 mt-1",children:"Vous ne pouvez pas supprimer votre propre compte."})]})]}),(0,l.jsx)("div",{className:"flex justify-end mt-6",children:(0,l.jsx)("button",{onClick:()=>D(!1),className:"px-4 py-2 bg-slate-100 text-slate-700 rounded-lg hover:bg-slate-200 transition-colors",children:"Compris"})})]})})]})}function et(){let{currentUser:e}=c(),[s,t]=(0,a.useState)("dashboard"),[r,i]=(0,a.useState)(null);if(!e)return(0,l.jsx)(f,{});let n=e=>{i(e),t("detail")},o=()=>{i(null),t("dashboard")},d=()=>{t("dashboard")};return(0,l.jsxs)("div",{className:"min-h-screen bg-slate-100",children:[(0,l.jsx)(_,{currentPage:s,onNavigate:e=>{t(e),"detail"!==e&&i(null)}}),(0,l.jsx)("main",{className:"lg:ml-64 pt-16 lg:pt-0 min-h-screen",children:(0,l.jsx)("div",{className:"p-4 lg:p-8",children:(()=>{switch(s){case"dashboard":default:return(0,l.jsx)(z,{onViewDetail:n});case"nouveau":return(0,l.jsx)(O,{onSuccess:d});case"detail":return r?(0,l.jsx)(H,{signalementId:r,onBack:o}):(0,l.jsx)(z,{onViewDetail:n});case"stats":return(0,l.jsx)(Q,{});case"admin":return(0,l.jsx)(es,{})}})()})})]})}function el(){return(0,l.jsx)(b,{children:(0,l.jsx)(et,{})})}}},function(e){e.O(0,[180,971,117,744],function(){return e(e.s=2267)}),_N_E=e.O()}]);